<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>STAT 5361: Statistical Computing, Fall 2018</title>
  <meta name="description" content="This is a series of notes for the students of STAT 5361, Statisticl Computing, at UConn.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="STAT 5361: Statistical Computing, Fall 2018" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a series of notes for the students of STAT 5361, Statisticl Computing, at UConn." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="STAT 5361: Statistical Computing, Fall 2018" />
  
  <meta name="twitter:description" content="This is a series of notes for the students of STAT 5361, Statisticl Computing, at UConn." />
  

<meta name="author" content="Jun Yan">


<meta name="date" content="2018-10-13">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  

<link rel="next" href="nla.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#a-teaser-example-likelihood-estimation"><i class="fa fa-check"></i><b>1.1</b> A Teaser Example: Likelihood Estimation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#computer-arithmetics"><i class="fa fa-check"></i><b>1.2</b> Computer Arithmetics</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#integers"><i class="fa fa-check"></i><b>1.2.1</b> Integers</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#floating-point"><i class="fa fa-check"></i><b>1.2.2</b> Floating Point</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#error-analysis"><i class="fa fa-check"></i><b>1.2.3</b> Error Analysis</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#condition-number"><i class="fa fa-check"></i><b>1.2.4</b> Condition Number</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-project"><i class="fa fa-check"></i><b>1.4</b> Course Project</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="nla.html"><a href="nla.html"><i class="fa fa-check"></i><b>2</b> Numerical Linear Algebra</a></li>
<li class="chapter" data-level="3" data-path="optim.html"><a href="optim.html"><i class="fa fa-check"></i><b>3</b> Optimization</a><ul>
<li class="chapter" data-level="3.1" data-path="optim.html"><a href="optim.html#univariate-optimizations"><i class="fa fa-check"></i><b>3.1</b> Univariate Optimizations</a><ul>
<li class="chapter" data-level="3.1.1" data-path="optim.html"><a href="optim.html#bisection-method"><i class="fa fa-check"></i><b>3.1.1</b> Bisection Method</a></li>
<li class="chapter" data-level="3.1.2" data-path="optim.html"><a href="optim.html#newtons-method"><i class="fa fa-check"></i><b>3.1.2</b> Newtonâ€™s Method</a></li>
<li class="chapter" data-level="3.1.3" data-path="optim.html"><a href="optim.html#fixed-point-iteration"><i class="fa fa-check"></i><b>3.1.3</b> Fixed Point Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="optim.html"><a href="optim.html#multivariate-optimization"><i class="fa fa-check"></i><b>3.2</b> Multivariate Optimization</a><ul>
<li class="chapter" data-level="3.2.1" data-path="optim.html"><a href="optim.html#newton-raphson-method"><i class="fa fa-check"></i><b>3.2.1</b> Newton-Raphson Method</a></li>
<li class="chapter" data-level="3.2.2" data-path="optim.html"><a href="optim.html#variants-of-newton-raphson-method"><i class="fa fa-check"></i><b>3.2.2</b> Variants of Newton-Raphson Method</a></li>
<li class="chapter" data-level="3.2.3" data-path="optim.html"><a href="optim.html#nelder-mead-simplex-algorithm"><i class="fa fa-check"></i><b>3.2.3</b> Nelder-Mead (Simplex) Algorithm</a></li>
<li class="chapter" data-level="3.2.4" data-path="optim.html"><a href="optim.html#optimization-with-r"><i class="fa fa-check"></i><b>3.2.4</b> Optimization with R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="optim.html"><a href="optim.html#mm-algorithm"><i class="fa fa-check"></i><b>3.3</b> MM Algorithm</a></li>
<li class="chapter" data-level="3.4" data-path="optim.html"><a href="optim.html#an-example-lasso-with-coordinate-descent"><i class="fa fa-check"></i><b>3.4</b> An Example: LASSO with Coordinate Descent</a></li>
<li class="chapter" data-level="3.5" data-path="optim.html"><a href="optim.html#exercises-1"><i class="fa fa-check"></i><b>3.5</b> Exercises</a><ul>
<li class="chapter" data-level="3.5.1" data-path="optim.html"><a href="optim.html#cauchy-with-unknown-location."><i class="fa fa-check"></i><b>3.5.1</b> Cauchy with unknown location.</a></li>
<li class="chapter" data-level="3.5.2" data-path="optim.html"><a href="optim.html#many-local-maxima"><i class="fa fa-check"></i><b>3.5.2</b> Many local maxima</a></li>
<li class="chapter" data-level="3.5.3" data-path="optim.html"><a href="optim.html#modeling-beetle-data"><i class="fa fa-check"></i><b>3.5.3</b> Modeling beetle data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="em-algorithm.html"><a href="em-algorithm.html"><i class="fa fa-check"></i><b>4</b> EM Algorithm</a><ul>
<li class="chapter" data-level="4.1" data-path="em-algorithm.html"><a href="em-algorithm.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="em-algorithm.html"><a href="em-algorithm.html#em-algorithm-1"><i class="fa fa-check"></i><b>4.2</b> EM Algorithm</a></li>
<li class="chapter" data-level="4.3" data-path="em-algorithm.html"><a href="em-algorithm.html#example-clustering-by-em"><i class="fa fa-check"></i><b>4.3</b> Example: Clustering by EM</a></li>
<li class="chapter" data-level="4.4" data-path="em-algorithm.html"><a href="em-algorithm.html#variants-of-em"><i class="fa fa-check"></i><b>4.4</b> Variants of EM</a><ul>
<li class="chapter" data-level="4.4.1" data-path="em-algorithm.html"><a href="em-algorithm.html#mcem"><i class="fa fa-check"></i><b>4.4.1</b> MCEM</a></li>
<li class="chapter" data-level="4.4.2" data-path="em-algorithm.html"><a href="em-algorithm.html#ecm"><i class="fa fa-check"></i><b>4.4.2</b> ECM</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="em-algorithm.html"><a href="em-algorithm.html#standard-errors"><i class="fa fa-check"></i><b>4.5</b> Standard Errors</a><ul>
<li class="chapter" data-level="4.5.1" data-path="em-algorithm.html"><a href="em-algorithm.html#supplemental-em-sem"><i class="fa fa-check"></i><b>4.5.1</b> Supplemental EM (SEM)</a></li>
<li class="chapter" data-level="4.5.2" data-path="em-algorithm.html"><a href="em-algorithm.html#direct-calculation-of-the-information-matrix"><i class="fa fa-check"></i><b>4.5.2</b> Direct Calculation of the Information Matrix</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="em-algorithm.html"><a href="em-algorithm.html#acceleration"><i class="fa fa-check"></i><b>4.6</b> Acceleration</a></li>
<li class="chapter" data-level="4.7" data-path="em-algorithm.html"><a href="em-algorithm.html#example-hidden-markov-model"><i class="fa fa-check"></i><b>4.7</b> Example: Hidden Markov Model</a></li>
<li class="chapter" data-level="4.8" data-path="em-algorithm.html"><a href="em-algorithm.html#exercises-2"><i class="fa fa-check"></i><b>4.8</b> Exercises</a><ul>
<li class="chapter" data-level="4.8.1" data-path="em-algorithm.html"><a href="em-algorithm.html#finite-mixture-regression"><i class="fa fa-check"></i><b>4.8.1</b> Finite mixture regression</a></li>
<li class="chapter" data-level="4.8.2" data-path="em-algorithm.html"><a href="em-algorithm.html#a-poisson-hmm-for-earthquake-data"><i class="fa fa-check"></i><b>4.8.2</b> A Poisson-HMM for earthquake data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="random-number-generation.html"><a href="random-number-generation.html"><i class="fa fa-check"></i><b>5</b> Random Number Generation</a><ul>
<li class="chapter" data-level="5.1" data-path="random-number-generation.html"><a href="random-number-generation.html#univariate-random-number-generation"><i class="fa fa-check"></i><b>5.1</b> Univariate Random Number Generation</a><ul>
<li class="chapter" data-level="5.1.1" data-path="random-number-generation.html"><a href="random-number-generation.html#inverse-cdf"><i class="fa fa-check"></i><b>5.1.1</b> Inverse CDF</a></li>
<li class="chapter" data-level="5.1.2" data-path="random-number-generation.html"><a href="random-number-generation.html#rejection-method"><i class="fa fa-check"></i><b>5.1.2</b> Rejection Method</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="random-number-generation.html"><a href="random-number-generation.html#exercises-3"><i class="fa fa-check"></i><b>5.2</b> Exercises</a><ul>
<li class="chapter" data-level="5.2.1" data-path="random-number-generation.html"><a href="random-number-generation.html#rejection-sampling"><i class="fa fa-check"></i><b>5.2.1</b> Rejection sampling</a></li>
<li class="chapter" data-level="5.2.2" data-path="random-number-generation.html"><a href="random-number-generation.html#mixture-proposal"><i class="fa fa-check"></i><b>5.2.2</b> Mixture Proposal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>6</b> Markov Chain Monte Carlo</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 5361: Statistical Computing, Fall 2018</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">STAT 5361: Statistical Computing, Fall 2018</h1>
<p class="author"><em>Jun Yan</em></p>
<p class="date"><em>2018-10-13</em></p>
</div>
<div id="prelim" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Prerequisites</h1>
<p>We assume that students can use R/Rstudio comfortably. If you are new to R, an
extra amount of hard work should be devoted to make it up. In addition to the
official documentations from the R-project, the presentations at a [local SIAM
workshop in Spring 2018] (<a href="https://siam.math.uconn.edu/events/" class="uri">https://siam.math.uconn.edu/events/</a>) given by Wenjie
Wang, a PhD student in Statistics at the time, can be enlighting:
- <a href="https://github.com/wenjie2wang/2018-01-19-siam" class="uri">https://github.com/wenjie2wang/2018-01-19-siam</a>
- <a href="https://github.com/wenjie2wang/2018-04-06-siam" class="uri">https://github.com/wenjie2wang/2018-04-06-siam</a></p>
<p>If you have used R, but never paid attention to R programming styles, a style clinic would be a necessary step. A good place to start is Googleâ€™s R style guide at <a href="https://google.github.io/styleguide/Rguide.xml" class="uri">https://google.github.io/styleguide/Rguide.xml</a>. From my experience, the two most commonly overlooked styles for beginners are spacing and indentation. Appropriate spacing and indentation would immediately make crowdly piled code much more eye-friendly. Such styles can be automatically enforced by R packages such as <strong>formatr</strong> or <strong>lintr</strong>. Tow important styles that cannot be automatically corrected are naming and documentation. As in any programming languate, naming of R objects (variables, functions, files, etc.) shoud be informative, concise, and consistent with certain naming convention. Documentation needs to be sufficient, concise, and kept close to the code; tools like R package <strong>roxygen2</strong> can be very helpful. See Hadley Wichhamâ€™s online book <a href="http://style.tidyverse.org/" class="uri">http://style.tidyverse.org/</a> for more detailed tips.</p>
<p>For intermediate R users who want a skill lift, The <strong>Advanced R Programming</strong> book <span class="citation">(Wickham <a href="#ref-wickham2014advanced">2014</a>)</span> by Hadley Wickham is available at <a href="https://adv-r.hadley.nz/" class="uri">https://adv-r.hadley.nz/</a>. The source that generated the book is kindly made available at GitHub: <a href="https://github.com/hadley/adv-r" class="uri">https://github.com/hadley/adv-r</a>. It is a great learning experience to complile the book from the source, during which you may pick up many necessary skills.</p>
<p>The homework, exam, and project will be completed by <strong>R Markdown</strong>. Following the step by step the instructions in Yihui Xieâ€™s online book on <strong>bookdown</strong> <span class="citation">(Xie <a href="#ref-xie2016bookdown">2016</a>)</span>.at <a href="https://bookdown.org/yihui/bookdown/" class="uri">https://bookdown.org/yihui/bookdown/</a>, you will be amazed how quickly you can learn to produce cool-looking documents and even book manuscripts. If you are a keener, you may as well following Yihuiâ€™s <strong>blogdown</strong>, see online book <a href="https://bookdown.org/yihui/blogdown/" class="uri">https://bookdown.org/yihui/blogdown/</a>, to build your own website using R Markdown.</p>
<p>All your source code will be version controlled by <strong>git</strong> and archived on <strong>GitHub</strong>. RStudio has made using git quite straightforward. The online tutorial by Jenny Bryan, Happy Git and GitHub for the useR, is a very useful tool to get started</p>
<div id="a-teaser-example-likelihood-estimation" class="section level2">
<h2><span class="header-section-number">1.1</span> A Teaser Example: Likelihood Estimation</h2>
<p>In mathematical statistics, we have learned that, under certain regularity conditions, the maximum likelihood estimator (MLE) is consistent, asymptotically normal, and most efficient. The asymptotic variance of the estimator if the inverse of the Fisher information matrix. Specifically, let <span class="math inline">\(X_1, \ldots, X_n\)</span> be a random sample from a distribution with density <span class="math inline">\(f(x; \theta)\)</span>, where <span class="math inline">\(\theta\)</span> is a parameter. How do we obtain the MLE?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="dv">4</span>)
<span class="kw">hist</span>(x)</code></pre>
<p><img src="index_files/figure-html/data-1.png" width="672" /></p>
<p>Package <strong>MASS</strong> provides a function <code>fitdistr()</code> to obtain the MLE for univariate distributions with a random sample. We can learn two things from this function. First, an objective function representing the negative loglikelihood is formed, depending on the input of the density function, and fed to the optimizer function <code>optim</code>. Second, the variance estimator of the MLE is obtained by inverting the Hessian matrix of the objective function, which is an estimator of the Fisher information matrix. For commonly used distributions, starting values are not necessary. The function computes moment estimator and use them as starting values.</p>
<pre class="sourceCode r"><code class="sourceCode r">MASS<span class="op">::</span><span class="kw">fitdistr</span>(x, <span class="dt">densfun =</span> <span class="st">&quot;gamma&quot;</span>)</code></pre>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre><code>##      shape         rate   
##   2.19321713   0.31850407 
##  (0.28968120) (0.04724651)</code></pre>
<p>For distributions not in the provided list, the <code>densfun</code> needs to be a function returning a density evaluated at its first arguments, in which case, the <code>start</code> argument needs to be a named list to feed to the optimizer. For example, pretend that someone has a fancy distribution which is just a rename of the gamma distribution. Its density function is defined based on the gamma density <code>dgamma</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">dfancy &lt;-<span class="st"> </span><span class="cf">function</span>(x, shape, scale, <span class="dt">log =</span> <span class="ot">FALSE</span>) {
  <span class="kw">dgamma</span>(x, <span class="dt">shape =</span> shape, <span class="dt">scale =</span> scale, <span class="dt">log =</span> log)
}

<span class="kw">suppressWarnings</span>(MASS<span class="op">::</span><span class="kw">fitdistr</span>(x, <span class="dt">densfun =</span> dfancy, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">10</span>, <span class="dt">scale =</span> <span class="dv">20</span>)))</code></pre>
<pre><code>##      shape       scale  
##   2.1931194   3.1400457 
##  (0.2897513) (0.4659625)</code></pre>
<p>The <strong>stats4</strong> package provides MLE using S4 classes.</p>
<pre class="sourceCode r"><code class="sourceCode r">nll &lt;-<span class="st"> </span><span class="cf">function</span>(shape, scale) <span class="op">-</span><span class="kw">sum</span>(<span class="kw">dfancy</span>(x, shape, scale, <span class="ot">TRUE</span>))
<span class="kw">suppressWarnings</span>(fit &lt;-<span class="st"> </span>stats4<span class="op">::</span><span class="kw">mle</span>(nll, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">10</span>, <span class="dt">scale =</span> <span class="dv">10</span>)))
stats4<span class="op">::</span><span class="kw">summary</span>(fit)</code></pre>
<pre><code>## Maximum likelihood estimation
## 
## Call:
## stats4::mle(minuslogl = nll, start = list(shape = 10, scale = 10))
## 
## Coefficients:
##       Estimate Std. Error
## shape 2.193213  0.2896847
## scale 3.139686  0.4657464
## 
## -2 log L: 557.1586</code></pre>
</div>
<div id="computer-arithmetics" class="section level2">
<h2><span class="header-section-number">1.2</span> Computer Arithmetics</h2>
<p><span class="citation">Burns (<a href="#ref-burns2012r">2012</a>)</span> summarizes many traps beginners may fall into. The first one is the floating number trap. Are you surprised by what you see in the following?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## floating point traps</span>
<span class="fl">.1</span> <span class="op">==</span><span class="st"> </span><span class="fl">.3</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.1</span>) <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span></code></pre>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.1</span>)</code></pre>
<pre><code>##  [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(<span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.4</span> <span class="op">-</span><span class="st"> </span><span class="fl">.1</span>, <span class="fl">.5</span> <span class="op">-</span><span class="st"> </span><span class="fl">.2</span>, <span class="fl">.6</span> <span class="op">-</span><span class="st"> </span><span class="fl">.3</span>, <span class="fl">.7</span> <span class="op">-</span><span class="st"> </span><span class="fl">.4</span>))</code></pre>
<pre><code>## [1] 0.3 0.3 0.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.4</span> <span class="op">-</span><span class="st"> </span><span class="fl">.1</span>, <span class="fl">.5</span> <span class="op">-</span><span class="st"> </span><span class="fl">.2</span>, <span class="fl">.6</span> <span class="op">-</span><span class="st"> </span><span class="fl">.3</span>, <span class="fl">.7</span> <span class="op">-</span><span class="st"> </span><span class="fl">.4</span>)</code></pre>
<pre><code>## [1] 0.3 0.3 0.3 0.3 0.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">20</span>)
<span class="fl">.1</span></code></pre>
<pre><code>## [1] 0.10000000000000000555</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="fl">.3</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span></code></pre>
<pre><code>## [1] 0.099999999999999991673</code></pre>
<p>How does a computer represent a number? Computers use switches, which has only two states, on and off, to represent numbers. That is, it uses the binary number system. With a finite (though large) number switches on a computer, not all real numbers are representable. Binary numbers are made of bits, each of which represent a switch. A byte is 8 bits, which represents one character.</p>
<div id="integers" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Integers</h3>
<p>An integer on many computers has length 4-byte or 32-bit.
It is represented by the coefficients <span class="math inline">\(x_i\)</span> in
<span class="math display">\[
\sum_{i=1}^{32} x_i 2^{i-1} - 2^{31},
\]</span>
where <span class="math inline">\(x_i\)</span> is either 0 or 1.</p>
<pre class="sourceCode r"><code class="sourceCode r">imax &lt;-<span class="st"> </span>.Machine<span class="op">$</span>integer.max
imax</code></pre>
<pre><code>## [1] 2147483647</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">imax <span class="op">+</span><span class="st"> </span>1L</code></pre>
<pre><code>## Warning in imax + 1L: NAs produced by integer overflow</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">log</span>(imax, <span class="dt">base =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## [1] 30.999999999328192501</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span>0L
b &lt;-<span class="st"> </span>1L
<span class="cf">for</span> (i <span class="cf">in</span> 1L<span class="op">:</span>31L) {
  u &lt;-<span class="st"> </span>u <span class="op">+</span><span class="st"> </span>b
  b &lt;-<span class="st"> </span>b <span class="op">*</span><span class="st"> </span>2L
}</code></pre>
<pre><code>## Warning in b * 2L: NAs produced by integer overflow</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">u</code></pre>
<pre><code>## [1] 2147483647</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">1000L <span class="op">*</span><span class="st"> </span>1000L <span class="op">*</span><span class="st"> </span>1000L</code></pre>
<pre><code>## [1] 1000000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">1000L <span class="op">*</span><span class="st"> </span>1000L <span class="op">*</span><span class="st"> </span>1000L <span class="op">*</span><span class="st"> </span>1000L</code></pre>
<pre><code>## Warning in 1000L * 1000L * 1000L * 1000L: NAs produced by integer overflow</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">1000L <span class="op">*</span><span class="st"> </span>1000L <span class="op">*</span><span class="st"> </span>1000L <span class="op">*</span><span class="st"> </span><span class="dv">1000</span></code></pre>
<pre><code>## [1] 1e+12</code></pre>
</div>
<div id="floating-point" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Floating Point</h3>
<p>A floating point number is represented by
<span class="math display">\[
(-1)^{x_0}\left(1 + \sum_{i=1}^t x_i 2^{-i}\right) 2^{k}
\]</span>
for <span class="math inline">\(x_i \in \{0, 1\}\)</span>,
where <span class="math inline">\(k\)</span> is an integer called the exponent,
<span class="math inline">\(x_0\)</span> is the sign bit.
The fractional part <span class="math inline">\(\sum_{i=1}^t x_i 2^{-i}\)</span> is the significand. By convention (for unique representation), the exponent is chosen so that the fist digit of the significand is 1, unless it would result in the exponent being out of range.</p>
<p>A standard double precision representation uses 8 bytes or 64 bits: a sign bit, an 11 bit exponent, and <span class="math inline">\(t = 52\)</span> bits for the significand. With 11 bits there are <span class="math inline">\(2^{11} = 2048\)</span> possible values for the exponent, which are usually shifted so that the allowed values range from <span class="math inline">\(-1022\)</span> to 1023, again with one special sign value.</p>
<p>The IEEE standard for floating point arithmetic calls for basic arithmetic operations to be performed to higher precision, and then rounded to the nearest representable floating point number.</p>
<p>Arithmetic underflow occurs where the result of a calculation is a smaller number than what the computer can actually represent. Arithmetic overflow occurs when a calculation produces a result that is greater in magnitude than what the computer can represent. Here is a demonstration <span class="citation">(Gray <a href="#ref-gray2001advanced">2001</a>)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">20</span>)
.Machine<span class="op">$</span>double.eps</code></pre>
<pre><code>## [1] 2.2204460492503130808e-16</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">.Machine<span class="op">$</span>double.base <span class="op">^</span><span class="st"> </span>.Machine<span class="op">$</span>double.ulp.digits</code></pre>
<pre><code>## [1] 2.2204460492503130808e-16</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>.Machine<span class="op">$</span>double.eps <span class="op">==</span><span class="st"> </span><span class="dv">1</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>.Machine<span class="op">$</span>double.base <span class="op">^</span><span class="st"> </span>(.Machine<span class="op">$</span>double.ulp.digits <span class="op">-</span><span class="st"> </span>1L) <span class="op">==</span><span class="st"> </span><span class="dv">1</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## largest possible significand</span>
u &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> 1L<span class="op">:</span><span class="dv">53</span>) u &lt;-<span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span>(<span class="op">-</span>i)
u</code></pre>
<pre><code>## [1] 0.99999999999999988898</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## and the largest possible exponent--note that calculating 2^1024</span>
<span class="co">## directly overflows</span>
u <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">^</span><span class="st"> </span><span class="dv">1023</span></code></pre>
<pre><code>## [1] 1.7976931348623157081e+308</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## next largest floating point number overflows</span>
(u <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">^</span><span class="st"> </span><span class="dv">1023</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">^</span><span class="dv">52</span>)</code></pre>
<pre><code>## [1] Inf</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## smallest possible mantissa and smallest possible exponent</span>
<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1022</span>)</code></pre>
<pre><code>## [1] 4.9406564584124654418e-324</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1022</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="error-analysis" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Error Analysis</h3>
<p>More generally, a floating point number with base <span class="math inline">\(\beta\)</span> can be represented as
<span class="math display">\[
(-1)^{x_0}\left(\sum_{i=1}^t x_i \beta^{-i}\right) \beta^{k},
\]</span>
where <span class="math inline">\(x_0 \in \{0, 1\}\)</span>, <span class="math inline">\(x_i \in \{0, 1, \ldots, \beta - 1\}\)</span>, <span class="math inline">\(i = 1, \ldots, t\)</span>, and <span class="math inline">\(E_{\min} \le k \le E_{\max}\)</span> for some <span class="math inline">\(E_{\min}\)</span> and <span class="math inline">\(E_{\max}\)</span>. For a binary system <span class="math inline">\(\beta = 2\)</span> while for the decimal system <span class="math inline">\(\beta = 10\)</span>. To avoid multiple representations, a normalized representation is defined by forcing the first significant digit (<span class="math inline">\(x_1\)</span>) to be non-zero. The numbers <span class="math inline">\(\{x: |x| &lt; \beta^{E_{\min} - 1}\}\)</span> (called subnormals) can not be normalized and, are sometimes excluded from the system. If an operation results in a subnormal number underflow is said to have occurred. Similarly if an operation results in a number with the exponent <span class="math inline">\(k &gt; E_{\max}\)</span>, overflow is said to have occurred.</p>
<p>Let <span class="math inline">\(f(x)\)</span> be the floating point representation of <span class="math inline">\(x\)</span>.
The relative error of <span class="math inline">\(f(x)\)</span> is <span class="math inline">\(\delta_x = [f(x) - x] / x\)</span>. The basic formula for error analysis is
<span class="math display">\[
f(x \circ y) = (1+ \epsilon_m) (x \circ y) 
\]</span>
where <span class="math inline">\(\circ\)</span> is an operator (e.g., add, subtract, multiple, divide, etc.), <span class="math inline">\((x \circ y)\)</span> is the exact result, and <span class="math inline">\(\epsilon_m\)</span> is the smallest positive floating-point number <span class="math inline">\(z\)</span> such that <span class="math inline">\(1 + z \ne 1\)</span>. <strong>Add demonstration from Section 1.3 of <span class="citation">Gray (<a href="#ref-gray2001advanced">2001</a>)</span>; see also [notes] (<a href="https://people.eecs.berkeley.edu/~demmel/cs267/lecture21/lecture21.html" class="uri">https://people.eecs.berkeley.edu/~demmel/cs267/lecture21/lecture21.html</a>). </strong></p>
<p>(Section 1.4 from Gray)
Consider computing <span class="math inline">\(x + y\)</span>, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> have the same sign. Let <span class="math inline">\(\delta_x\)</span> and <span class="math inline">\(\delta_y\)</span> be the relative error in the floating point representation of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, respectively (e.g., <span class="math inline">\(\delta_x = [f(x) - x]/x\)</span>, so <span class="math inline">\(f(x) = x(1 + \delta_x)\)</span>). What the computer actually calculates is the sum of the floating point representations <span class="math inline">\(f (x) + f (y)\)</span>, which may not have an exact floating point representation, in which case it is rounded to the nearest representable number <span class="math inline">\(f(f(x) + f(y))\)</span>. Let <span class="math inline">\(\delta_s\)</span> be the relative error of the <span class="math inline">\(f(f(x) + f(y))\)</span>. Then,
<span class="math display">\[\begin{align*}
&amp;\,\, |f(f(x)+f(y)) - x+y)| \\ 
&amp;= |f(f(x)+f(y)) - f(x) - f(y) + f(x)-x+f(y)-y| \\
&amp;\le |\delta_s[f(x) + f(y)]| + |\delta_x x| + |\delta_y y|\\
&amp;\le |x+y|(\epsilon_m + \epsilon^2_m) + |x+y| \epsilon_m \\
&amp;\approx 2\epsilon_m |x+y|,
\end{align*}\]</span>
where the higher order terms in <span class="math inline">\(\epsilon_m\)</span> have been dropped, since they are usually negligible. Thus <span class="math inline">\(2\epsilon_m\)</span> is an (approximate) bound on the relative error in a single addition of two numbers with the same sign.</p>

<div class="example">
<p><span id="exm:sum" class="example"><strong>Example 1.1  (Computing sample sum)  </strong></span>(Section 1.5.1 of Srivistava (2009))
Let <span class="math inline">\(x_1, \ldots, x_n\)</span> be the observations from a random of size <span class="math inline">\(n\)</span>. The simplest algorithm to compute the sample sum is to start from <span class="math inline">\(s_0 = 0\)</span> and add one term each time <span class="math inline">\(s_j = s_{j-1} + x_j\)</span>. Each addition may result in a number that is not a floating number, with an error denoted by multiple <span class="math inline">\((1 + \epsilon)\)</span> to that number.</p>
For example, when <span class="math inline">\(n = 3\)</span>, suppose that <span class="math inline">\((x_1, x_2, x_3)\)</span> are floating numbers. We have:
<span class="math display">\[\begin{align*}  
f(s_1) &amp;= (0 + x_1)(1 + \epsilon_1)\\
f(s_2) &amp;= (f(s_1) + x_2)(1 + \epsilon_2)\\
f(s_3) &amp;= (f(s_2) + x_3)(1 + \epsilon_3)
\end{align*}\]</span>
It can be seen that
<span class="math display">\[\begin{align*}
f(s_3) = (x_1 + x_2 + x_3) + x_1 (\epsilon_1 + \epsilon_2 + \epsilon_3) + x_2 (\epsilon_2 + \epsilon_3) + x_3(\epsilon_3) + o(\epsilon_m).
\end{align*}\]</span>
The cumulative error is approximately
<span class="math display">\[\begin{align*}
&amp;\phantom{=} \| f(s_3) - (x_1 + x_2 + x_3)\| \\
&amp;\sim \| x_1 (\epsilon_1 + \epsilon_2 + \epsilon_3) + x_2 (\epsilon_2 + \epsilon_3) + x_3(\epsilon_3) \|\\
&amp;\le \|x_1\| (\|\epsilon_1\| + \|\epsilon_2\| + \|\epsilon_3\|) + \|x_2\| (\|\epsilon_2\| + \|\epsilon_3\|) + \|x_3\| \|\epsilon_3\| \\
&amp;\le (3 \|x_1\| + 2\|x_2\| + \|x_3\|) \epsilon_m.
\end{align*}\]</span>
This suggests that better accuracy can be achieved at the expense of sorting in increasing order before computing the sum.
</div>

<p><strong>Todo: design a decimal system with limited precision to demonstrate the error analysis </strong></p>
<p>Subtracting one number from another number of similar magnitude can lead to
large relative error. This is more easily illustrated using a decimal system
(<span class="math inline">\(\beta = 10\)</span>); see Section~1.4 of <span class="citation">Srivastava (<a href="#ref-srivastava2009computational">2009</a>)</span>. For simplicity, consider the case with <span class="math inline">\(t = 4\)</span>. Let <span class="math inline">\(x = 122.9572\)</span> and <span class="math inline">\(y = 123.1498\)</span>. Their floating point representations are <code>(1230, 3)</code> and <code>(1231, 3)</code>. The resulting difference is <span class="math inline">\(-0.1\)</span> while the actual answer is <span class="math inline">\(-0.1926\)</span>. The idea is the same on a binary system.</p>
<p>Consider an extreme case:
<span class="math display">\[\begin{align*}
f(x) &amp;= 1 / 2 + \sum_{i=2}^{t-1} x_i / 2^i + 1 / 2^t,\\
f(y) &amp;= 1 / 2 + \sum_{i=2}^{t-1} x_i / 2^i + 0 / 2^t.
\end{align*}\]</span>
The absolute errors of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(f(y)\)</span> are in <span class="math inline">\((0, 1/2^{t+1})\)</span>.
The true difference <span class="math inline">\(x - y\)</span> could be anywhere in <span class="math inline">\((0, 1 / 2^{t-1})\)</span>
The computed subtraction is <span class="math inline">\(f(x) - f(y) = 1 / 2^t\)</span>.
So the relative error can be arbitrarily large.</p>
<p>The error from subtraction operation also explains why approximating <span class="math inline">\(e^{x}\)</span> by partial sums does not work well for negative <span class="math inline">\(x\)</span> with a large magnitude. Consider an implementation of the exponential function with the Taylor series
<span class="math inline">\(\exp(x) = \sum_{i=0}^{\infty} x^i / i!\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">fexp &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  i &lt;-<span class="st"> </span><span class="dv">0</span>
  expx &lt;-<span class="st"> </span><span class="dv">1</span>
  u &lt;-<span class="st"> </span><span class="dv">1</span>
  <span class="cf">while</span> (<span class="kw">abs</span>(u) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>.e<span class="dv">-8</span> <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(expx)) {
    i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    u &lt;-<span class="st"> </span>u <span class="op">*</span><span class="st"> </span>x <span class="op">/</span><span class="st"> </span>i
    expx &lt;-<span class="st"> </span>expx <span class="op">+</span><span class="st"> </span>u
  }
  expx
}


<span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">10</span>)
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)
<span class="kw">cbind</span>(<span class="kw">exp</span>( x), <span class="kw">sapply</span>( x, fexp))</code></pre>
<pre><code>##                 [,1]            [,2]
## [1,] 2.202646579e+04 2.202646575e+04
## [2,] 4.851651954e+08 4.851651931e+08
## [3,] 1.068647458e+13 1.068647454e+13</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(<span class="kw">exp</span>(<span class="op">-</span>x), <span class="kw">sapply</span>(<span class="op">-</span>x, fexp))</code></pre>
<pre><code>##                 [,1]             [,2]
## [1,] 4.539992976e-05  4.539992956e-05
## [2,] 2.061153622e-09  5.621884467e-09
## [3,] 9.357622969e-14 -3.066812359e-05</code></pre>
<p>The accuracy is poor for <span class="math inline">\(x &lt; 0\)</span>. The problem in accuracy occurs because the terms alternate in sign, and some of the terms are much greater than the final answer. It can be fixed by noting that <span class="math inline">\(\exp(-x) = 1 / \exp(x)\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">fexp2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="cf">if</span> (x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">fexp</span>(x) <span class="cf">else</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">fexp</span>(<span class="op">-</span>x)
}

<span class="kw">cbind</span>(<span class="kw">exp</span>(<span class="op">-</span>x), <span class="kw">sapply</span>(<span class="op">-</span>x, fexp2))</code></pre>
<pre><code>##                 [,1]            [,2]
## [1,] 4.539992976e-05 4.539992986e-05
## [2,] 2.061153622e-09 2.061153632e-09
## [3,] 9.357622969e-14 9.357623008e-14</code></pre>
</div>
<div id="condition-number" class="section level3">
<h3><span class="header-section-number">1.2.4</span> Condition Number</h3>
<p>(Wiki)
In numerical analysis, the condition number of a function with respect to an argument measures how much the output value of the function can change for a small change in the input argument. This is used to measure how sensitive a function is to changes or errors in the input, and how much error in the output results from an error in the input.</p>
<p>The condition number is an application of the derivative, and is formally defined as the value of the asymptotic worst-case relative change in output for a relative change in input. The <code>function'' is the solution of a problem and the</code>argumentsâ€™â€™ are the data in the problem. The condition number is frequently applied to questions in linear algebra, in which case the derivative is straightforward but the error could be in many different directions, and is thus computed from the geometry of the matrix. More generally, condition numbers can be defined for non-linear functions in several variables.</p>
<p>A problem with a low condition number is said to be well-conditioned, while a problem with a high condition number is said to be ill-conditioned. The condition number is a property of the problem. Paired with the problem are any number of algorithms that can be used to solve the problem, that is, to calculate the solution. Some algorithms have a property called backward stability. In general, a backward stable algorithm can be expected to accurately solve well-conditioned problems. Numerical analysis textbooks give formulas for the condition numbers of problems and identify the backward stable algorithms. In the exponential function example, the first implementation is unstable for large negative <span class="math inline">\(x\)</span> while the second is stable.</p>
<p>It is important in likelihood maximization to work on the log scale. Use argument <code>log</code> in <code>dpq</code> functions instead of taking logs. This can be important in probalistic networks and MC(MC) where <span class="math inline">\(P = P_1 Â· P_2 \cdots Â· P_n\)</span> quickly underflows to zero.</p>
<p>It is also important to use <code>log1p</code> and <code>expm1</code> alike when caculating <span class="math inline">\(\log(1 + x)\)</span> and <span class="math inline">\(\exp(x)- 1\)</span> when <span class="math inline">\(|x| \ll 1\)</span>. One example is the evaluation of distribution and density function of the generalized extreme value (GEV) distribution. The GEV distribution has distribution function
<span class="math display">\[\begin{equation*}
F(x; \mu, \sigma, \xi) = 
\begin{cases}
\exp[- \left[ 1 + \left(\frac{x - \mu}{\sigma}\right) \xi\right]^{-1 / \xi} &amp; \xi \ne 0, \quad (1 + \xi (x - \mu) / \sigma) &gt; 0,\\
\exp[e^{ -(x - \mu) / \sigma}] &amp; \xi = 0,
\end{cases}
\end{equation*}\]</span>
for <span class="math inline">\(\mu \in R\)</span>, <span class="math inline">\(\sigma &gt; 0\)</span>, <span class="math inline">\(\xi \in R\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(evir<span class="op">::</span><span class="kw">pgev</span>(<span class="dv">1</span>, <span class="dt">xi =</span> x),    <span class="fl">1e-20</span>, <span class="fl">.01</span>, <span class="dt">log=</span><span class="st">&quot;x&quot;</span>, <span class="dt">n =</span> <span class="dv">1025</span>)
<span class="kw">curve</span>(texmex<span class="op">::</span><span class="kw">pgev</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, x), <span class="fl">1e-20</span>, <span class="fl">.01</span>, <span class="dt">log=</span><span class="st">&quot;x&quot;</span>, <span class="dt">n =</span> <span class="dv">1025</span>)</code></pre>
<div class="figure"><span id="fig:gev"></span>
<img src="index_files/figure-html/gev-1.png" alt="Two implementations of GEV distribution function when $\xi$ is close to zero." width="50%" /><img src="index_files/figure-html/gev-2.png" alt="Two implementations of GEV distribution function when $\xi$ is close to zero." width="50%" />
<p class="caption">
Figure 1.1: Two implementations of GEV distribution function when <span class="math inline">\(\xi\)</span> is close to zero.
</p>
</div>
<p>Figure <a href="index.html#fig:gev">1.1</a> shows a comparison of evaluating the GEV distribution function at <span class="math inline">\(x = 1\)</span> for <span class="math inline">\(\mu = 0\)</span>, <span class="math inline">\(\sigma = 1\)</span>, and a sequence of <span class="math inline">\(\xi\)</span> values near zero using two implementations.</p>
</div>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">1.3</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Use git to clone the source of Hadley Wickhamâ€™s <strong>Advanced R Programming</strong>
from his GitHub repository to a local space on your own computer. Build the book using RStudio. During the building process, you may see error messages due to missing tools on your computer. Read the error messages carefully and fix them, until you get the book built. You may need to install some R packages, some fonts, some latex packages, and some building tools for R packages. On Windows, some codes for parallel computing may not work and need to be swapped out. Document the problems you encountered and how you solved them in an R Markdown file named <code>README.Rmd</code>. Push it to your homework GitHub repository so that it can help other students to build the book.</p></li>
<li><p>Use <strong>bookdown</strong> or <strong>rmarkdown</strong> to produce a report for the following task. Consider approximation of the distribution function of <span class="math inline">\(N(0, 1)\)</span>,
<span class="math display" id="eq:cdf">\[\begin{equation}
\Phi(t) = \int_{-\infty}^t \frac{1}{\sqrt{2\pi}} e^{-y^2 / 2} dy,
\tag{1.1}
\end{equation}\]</span>
by the Monte Carlo methods:
<span class="math display">\[\begin{equation}
\hat\Phi(t) = \frac{1}{n} \sum_{i=1}^n I(X_i \le t),
\end{equation}\]</span>
where <span class="math inline">\(X_i\)</span>â€™s are iid <span class="math inline">\(N(0, 1)\)</span> variables.
Experiment with the approximation at <span class="math inline">\(n \in \{10^2, 10^3, 10^4\}\)</span> at <span class="math inline">\(t \in \{0.0, 0.67, 0.84, 1.28, 1.65, 2.32, 2.58, 3.09, 3.72\}\)</span> to form a table.</p></li>
</ol>
<p>The table should include the true value for comparison.
Further, repeat the experiment 100 times. Draw box plots of the 100 approximation errors at each <span class="math inline">\(t\)</span> using <strong>ggplot2</strong> <span class="citation">(Wickham et al. <a href="#ref-R-ggplot2">2018</a>)</span> for each <span class="math inline">\(n\)</span>. The report should look like a manuscript, with a title, an abstract, and multiple sections. It should contain at least one math equation, one table, one figure, and one chunk of R code. The template of our Data Science Lab can be helpful: <a href="https://statds.org/template/" class="uri">https://statds.org/template/</a>, the source of which is at <a href="https://github.com/statds/dslab-templates" class="uri">https://github.com/statds/dslab-templates</a>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Explain how <code>.Machine$double.xmax</code>, <code>.Machine$double.xmin</code>, <code>.Machine$double.eps</code>, and <code>.Machine@double.neg.eps</code> are defined using the 64-bit double precision floating point arithmetic.</li>
</ol>
</div>
<div id="course-project" class="section level2">
<h2><span class="header-section-number">1.4</span> Course Project</h2>
<p>Each student is required to work independently on a class project on a topic of your choice that involves computing. Examples are an investigation of the properties of a methodology you find interesting, a comparison of several methods on a variety of problems, a comprehensive analysis of a real data with methodologies from the course, or an R package. The project should represent new work, not something you have done for another course or as part of your thesis. I have a collection of small problems that might be suitable. Projects from <a href="http://www.kaggle.com/competitions">Kaggle data science competitions</a>
may be good choices too.</p>
<ul>
<li>Project proposal is due in week 7, the middle of the semester. This is a detailed, one-page description of what you plan to do, including question(s) to be addressed and models/methods to be used.</li>
<li>Project interim report is due in week 12. This informal report will indicate that your project is ``on trackâ€™â€™. The report includes results obtained thus far and a brief summary of what they mean and what remains to be done. Students often start working on this too late.
Your do not want to make the same mistake.</li>
<li>Final project report is due in the exam week. The final form of the report should use the Data Science Lab template, of no more than 6 pages (single spaced, font no smaller than 11pt, 1 inch margin, with references, graphics and tables included).</li>
<li>With more effort, a good project can turn into
a paper and be submitted to ENAR student paper competition
(Oct.Â 15) and ASA student paper competition (Dec.Â 15).</li>
</ul>
<p>Project ideas:</p>
<ul>
<li>An animated demonstration of different methods in <strong>optimx</strong> with data examples.</li>
<li>Accelerated EM algorithm</li>
<li>Simulation from empirical distributions joined by copulas</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wickham2014advanced">
<p>Wickham, Hadley. 2014. <em>Advanced R</em>. Chapman; Hall/CRC.</p>
</div>
<div id="ref-xie2016bookdown">
<p>Xie, Yihui. 2016. <em>bookdown: Authoring Books and Technical Documents with R Markdown</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://github.com/rstudio/bookdown" class="uri">https://github.com/rstudio/bookdown</a>.</p>
</div>
<div id="ref-burns2012r">
<p>Burns, Patrick. 2012. <em>The R Inferno</em>. Lulu. com.</p>
</div>
<div id="ref-gray2001advanced">
<p>Gray, Robert. 2001. <em>Advanced Statistical Computing</em>.</p>
</div>
<div id="ref-srivastava2009computational">
<p>Srivastava, Anuj. 2009. <em>Computational Methods in Statistics</em>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, and Kara Woo. 2018. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2" class="uri">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="nla.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["stat5361-book.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
